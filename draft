#include "main.h"

void cd(char *dir) {
  char *old_dir;

  if (dir == NULL) {
    dir = getenv("HOME");
  }

  if (dir == NULL) {
    fprintf(stderr, "cd: invalid directory\n");
    return;
  }

  old_dir = getenv("OLDPWD");
  if (strcmp(dir, "-") == 0) {
    dir = old_dir;
  }

  if (chdir(dir) < 0) {
    fprintf(stderr, "cd: cannot change directory to '%s'\n", dir);
    return;
  }

  /*if (old_dir != NULL) {
    unsetenv("OLDPWD");
  }*/
  setenv("PWD", dir, 1);
}


/*void	pwd_update()
{
	char	cwd[1024];
	if (getcwd(cwd, sizeof(cwd)) != NULL)
	{
		_setenv("PWD", cwd, 1);
	}
	else
	{
		write(2, "getcwd error\n", 13);
	}
}

int	_cd(char	*path)
{
	char	*newdir = NULL;
	char	*previous_dir = NULL;

	if (path != NULL)
	{
		newdir = path;
		return (0);
	}
	else
	{
		newdir = _getenv("HOME");
		return (0);
	}
	if (_strcmp(path, "-") == 0)
	{
		previous_dir = _getenv("OLDPWD");
		if (previous_dir != NULL)
		{
			newdir = previous_dir;
			return (0);
		}
		else
		{
			write(2, "OLDPWD not set\n", 15);
			return (1);
		}
	}
	if (chdir(newdir) == 0)
	{
		pwd_update();
		return (0);
	}
	else
	{
		write(2, "chdir error\n", 12);
		return (1);
	}
}*/
